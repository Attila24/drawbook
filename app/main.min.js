!function e(r,t,n){function o(s,i){if(!t[s]){if(!r[s]){var u="function"==typeof require&&require;if(!i&&u)return u(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=t[s]={exports:{}};r[s][0].call(c.exports,function(e){var t=r[s][1][e];return o(t?t:e)},c,c.exports,e,r,t,n)}return t[s].exports}var a="function"==typeof require&&require;for(var s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,r,t){!function(){"use strict";function e(e,r){e.baseUrl=r.url;e.signupUrl="/users/register";e.loginUrl="/users/login"}e.$inject=["$authProvider","server"];r.exports=e}()},{}],2:[function(e,r,t){!function(){"use strict";r.exports={url:"http://localhost:5000/api/"}}()},{}],3:[function(e,r,t){!function(){"use strict";angular.module("drawbook",["ngAnimate","ui.router","mgcrea.ngStrap","satellizer","LocalStorageModule","ngFileUpload"]).constant("server",e("./app.constants")).factory("UserService",e("./app/services/UserService")).factory("ImageService",e("./app/services/ImageService")).factory("CommentService",e("./app/services/CommentService")).config(e("./app.routes")).config(e("./app.auth"))}()},{"./app.auth":1,"./app.constants":2,"./app.routes":4,"./app/services/CommentService":10,"./app/services/ImageService":11,"./app/services/UserService":12}],4:[function(e,r,t){!function(){"use strict";function t(r,t,n){var o;r.state("home",{url:"/",templateUrl:"/app/common/home.tpl.html",controller:e("./app/common/HomeController"),controllerAs:"vm"}).state("register",{url:"/register",templateUrl:"/app/common/register.tpl.html",controller:e("./app/common/RegisterController"),controllerAs:"vm"}).state("login",{url:"/login",templateUrl:"/app/common/login.tpl.html",controller:e("./app/common/LoginController"),controllerAs:"vm"}).state("draw",{url:"/draw",templateUrl:"/app/draw/draw.tpl.html",controller:e("./app/draw/DrawController"),controllerAs:"vm"}).state("edit",{url:"/edit",templateUrl:"/app/common/profile-edit.tpl.html",controller:e("./app/common/ProfileEditController"),controllerAs:"vm"}).state("user",{"abstract":!0,url:"/:username",templateUrl:"/app/user/user.tpl.html",controller:e("./app/user/UserController"),controllerAs:"vm",resolve:{user:["$stateParams","UserService",function(e,r){return r.get(e.username)}]}}).state("user.gallery",{url:"/",templateUrl:"/app/user/user.gallery.tpl.html",controller:e("./app/user/UserGalleryController"),controllerAs:"vm"}).state("user.gallery.image",{url:"image/:id",params:{index:null},onEnter:["$modal","$state","user","$stateParams",function(r,t,n,a){o=r({templateUrl:"/app/user/user.image.tpl.html",controller:e("./app/user/UserImageController"),controllerAs:"vm",resolve:{user:function(){return n}},container:"body",animation:"am-fade",backdropAnimation:"backdrop-anim",position:"center",keyboard:!1,backdrop:!1})}]});t.otherwise("/");n.html5Mode(!0)}t.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"];r.exports=t}()},{"./app/common/HomeController":5,"./app/common/LoginController":6,"./app/common/ProfileEditController":7,"./app/common/RegisterController":8,"./app/draw/DrawController":9,"./app/user/UserController":13,"./app/user/UserGalleryController":14,"./app/user/UserImageController":15}],5:[function(e,r,t){!function(){"use strict";function e(e,r,t){function n(){t.get().then(function(e){s.users=e})}function o(){return e.isAuthenticated()}function a(){e.logout();r.remove("currentUser")}var s=this;s.title="HomeController";s.user=r.get("currentUser");s.isAuthenticated=o;s.logout=a;o()&&n()}angular.module("drawbook").controller("HomeController",e);e.$inject=["$auth","localStorageService","UserService"];r.exports=e}()},{}],6:[function(e,r,t){!function(){"use strict";function e(e,r,t){function n(){var n={username:o.user.name,password:o.user.password};r.login(n).then(function(r){t.set("currentUser",r.data.user);e.go("home")})["catch"](function(e){console.log("error: "+e);o.incorrectLogin=!0})}var o=this;o.title="LoginController";o.login=n;o.incorrectLogin=!1}angular.module("drawbook").controller("LoginController",e);e.$inject=["$state","$auth","localStorageService"];r.exports=e}()},{}],7:[function(e,r,t){!function(){"use strict";function e(e,r,t,n,o){function a(){t.get(l).then(function(e){u.user=e.user;u.avatarPath=u.user.avatarPath||"img/default-avatar.jpg"})["catch"](function(e){})}function s(){t.update(u.user);i();e.go("home")}function i(){var e=u.file;if(e){e.upload=n.upload({url:o.url+"/users/"+u.user.username+"/images/avatar",data:{file:e}});e.upload.then(function(r){e.result=r},function(e){e.status>0&&(u.errorMsg=e.status+": "+e.data)},function(r){e.progress=Math.min(100,parseInt(100*r.loaded/r.total))})}}var u=this;u.title="ProfileEditController";u.edit=s;u.genders=["Male","Female"];u.upload=i;var l=r.get("currentUser").username;a()}angular.module("drawbook").controller("ProfileEditController",e);e.$inject=["$state","localStorageService","UserService","Upload","server"];r.exports=e}()},{}],8:[function(e,r,t){!function(){"use strict";function e(e,r,t,n){function o(){t.get(s.user.username).then(function(e){s.takenUsername=null!=e.user})["catch"](function(e){console.log("Server problem")})}function a(){var t={username:s.user.username,password:s.user.password,firstName:s.user.firstName,lastName:s.user.lastName,age:s.user.age,gender:s.user.gender};r.signup(t).then(function(o){console.log(o);n.set("currentUser",o.data.user);r.login(t).then(function(r){e.go("home")})["catch"](function(e){console.log("Error "+e)})})["catch"](function(e){console.log("Error "+e)})}var s=this;s.title="RegisterController";s.genders=["Male","Female"];s.takenUsername=!1;s.checkUsername=o;s.register=a}angular.module("drawbook").controller("RegisterController",e);e.$inject=["$state","$auth","UserService","localStorageService"];r.exports=e}()},{}],9:[function(e,r,t){!function(){"use strict";function e(e,r,t){function n(){var n=$("<canvas>").attr({width:600,height:600});var a=n[0].getContext("2d");var s=[];$(".canvas").each(function(){s.push({canvas:$(this),zindex:parseInt($(this).css("z-index"))})});s.sort(function(e,r){return e.zindex-r.zindex});for(var i=0;i<s.length;i++)a.drawImage(s[i].canvas[0],0,0);var u=n[0].toDataURL();var l=r.get("currentUser").username;t.post(l,u,o.imagetitle).then(function(r){e.go("home")})["catch"](function(e){})}var o=this;o.title="DrawController";o.saveImage=n}angular.module("drawbook").controller("DrawController",e);e.$inject=["$state","localStorageService","ImageService"];r.exports=e}()},{}],10:[function(e,r,t){!function(){"use strict";function e(e,r,t){return{post:function(n,o,a,s){var i=e.defer();r.post(t.url+"/users/"+n+"/images/"+o+"/comments/",{author:s.username,authorAvatar:s.avatarPath,comment:a}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)});return i.promise},get:function(n,o){var a=e.defer();r.get(t.url+"/users/"+n.username+"/images/"+o).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)});return a.promise}}}e.$inject=["$q","$http","server"];r.exports=e}()},{}],11:[function(e,r,t){!function(){"use strict";function e(e,r,t){return{get:function(n,o){var a=e.defer();r({method:"GET",url:t.url+"users/"+n+"/images/"+o,headers:{"Content-Type":"images/png"}}).then(function(e){a.resolve({data:e,id:o})},function(e){a.reject(e)});return a.promise},post:function(n,o,a){var s=e.defer();r.post(t.url+"users/"+n+"/images/",{title:a,image:o}).success(function(e){s.resolve(e)}).error(function(e){s.reject("rejected: "+e)});return s.promise},"delete":function(n,o){var a=e.defer();r["delete"](t.url+"users/"+o+"/images/"+n).success(function(e){a.resolve(e)}).error(function(e){a.reject("rejected: "+e)});return a.promise}}}e.$inject=["$q","$http","server"];r.exports=e}()},{}],12:[function(e,r,t){!function(){"use strict";function e(e,r,t){return{get:function(n){var o=e.defer();var a=n?t.url+"users/"+n:t.url+"users/";r.get(a).success(function(e){o.resolve(e)}).error(function(e){o.reject("rejected: "+e)});return o.promise},update:function(n){var o=e.defer;r.patch(t.url+"users/"+n.username,{user:n}).success(function(e){}).error(function(e){o.reject("rejected: "+e)});return o.promise}}}e.$inject=["$q","$http","server"];r.exports=e}()},{}],13:[function(e,r,t){!function(){"use strict";function e(e,r,t,n){var o=this;o.title="UserController";o.images=[];o.user=n.user}angular.module("drawbook").controller("UserController",e);e.$inject=["$stateParams","UserService","ImageService","user"];r.exports=e}()},{}],14:[function(e,r,t){!function(){"use strict";function e(e,r,t){function n(){a.loaded=a.user.images.length<s?a.user.images.length:s;for(var e=0;e<a.loaded;e++)r.get(a.user.username,a.user.images[e]._id).then(function(e){a.images.push(e.data.data)})["catch"](function(e){})}function o(){a.current=a.loaded;a.loaded=a.user.images.length<a.loaded+s?a.user.images.length:a.loaded+s;console.log("current: "+a.current);console.log("loaded: "+a.loaded);for(var e=a.current;e<a.loaded;e++)r.get(a.user.username,a.user.images[e]._id).then(function(e){a.images.push(e.data.data)})["catch"](function(e){});console.log(a.images)}var a=this;a.title="UserGalleryController";a.user=e.user;a.images=[];const s=12;a.loadMore=o;n()}angular.module("drawbook").controller("UserGalleryController",e);e.$inject=["user","ImageService","$state"];r.exports=e}()},{}],15:[function(e,r,t){!function(){"use strict";function e(e,r,t,n,o,a,s){function i(){$(window).on("click",function(e){$(e.target).is(".modal")&&n.go("user.gallery",{user:m.username}).then(function(){o.$hide()})});void 0!==m.index&&null!==m.index||(m.index=m.user.images.map(function(e){return e._id}).indexOf(e.id));if(1==m.user.images.length)m.prev=m.next=void 0;else if(0==m.index){m.next=m.user.images[m.index+1]._id;m.prev=void 0}else if(m.index>0&&m.index<m.user.images.length-1){m.prev=m.user.images[m.index-1]._id;m.next=m.user.images[m.index+1]._id}else if(m.index==m.user.images.length-1){m.prev=m.user.images[m.index-1]._id;m.next=void 0}r.get(m.user.username,e.id).then(function(e){m.image=e.data.data})["catch"](function(e){});u()}function u(){a.get(m.user.username,e.id).then(function(e){m.comments=e.image.comments;console.log(m.comments)})["catch"](function(e){})}function l(e){void 0!=m.prev&&37==e?n.go("user.gallery.image",{id:m.prev,index:m.index-1}).then(function(){o.$hide()}):void 0!=m.next&&39==e?n.go("user.gallery.image",{id:m.next,index:m.index+1}).then(function(){o.$hide()}):27==e&&n.go("user.gallery",{user:m.username}).then(function(){o.$hide()})}function c(){a.post(m.user.username,e.id,m.comment,s.get("currentUser")).then(function(e){m.comment="";u()})["catch"](function(e){})}var m=this;m.title="UserImageController";m.user=t.user;m.index=e.index;m.navigate=l;m.addComment=c;i()}angular.module("drawbook").controller("UserImageController",e);e.$inject=["$stateParams","ImageService","user","$state","$scope","CommentService","localStorageService"];r.exports=e}()},{}]},{},[3]);
//# sourceMappingURL=main.min.js.map
