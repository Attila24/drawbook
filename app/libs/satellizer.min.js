/**
 * Satellizer 0.13.4
 * (c) 2016 Sahat Yalkabov
 * License: MIT
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="satellizer"),function(e,t,r){"use strict";e.location.origin||(e.location.origin=e.location.protocol+"//"+e.location.host),t.module("satellizer",[]).constant("SatellizerConfig",{httpInterceptor:function(){return!0},withCredentials:!1,tokenRoot:null,cordova:!1,baseUrl:"/",loginUrl:"/auth/login",signupUrl:"/auth/signup",unlinkUrl:"/auth/unlink/",tokenName:"token",tokenPrefix:"satellizer",authHeader:"Authorization",authToken:"Bearer",storageType:"localStorage",providers:{facebook:{name:"facebook",url:"/auth/facebook",authorizationEndpoint:"https://www.facebook.com/v2.5/dialog/oauth",redirectUri:e.location.origin+"/",requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",display:"popup",oauthType:"2.0",popupOptions:{width:580,height:400}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:e.location.origin,requiredUrlParams:["scope"],optionalUrlParams:["display"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633}},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",redirectUri:e.location.origin,optionalUrlParams:["scope"],scope:["user:email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1020,height:618}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",redirectUri:e.location.origin,requiredUrlParams:["scope"],scope:["basic"],scopeDelimiter:"+",oauthType:"2.0"},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/uas/oauth2/authorization",redirectUri:e.location.origin,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",state:"STATE",oauthType:"2.0",popupOptions:{width:527,height:582}},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",redirectUri:e.location.origin,oauthType:"1.0",popupOptions:{width:495,height:645}},twitch:{name:"twitch",url:"/auth/twitch",authorizationEndpoint:"https://api.twitch.tv/kraken/oauth2/authorize",redirectUri:e.location.origin,requiredUrlParams:["scope"],scope:["user_read"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",redirectUri:e.location.origin,requiredUrlParams:["display","scope"],scope:["wl.emails"],scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:500,height:560}},yahoo:{name:"yahoo",url:"/auth/yahoo",authorizationEndpoint:"https://api.login.yahoo.com/oauth2/request_auth",redirectUri:e.location.origin,scope:[],scopeDelimiter:",",oauthType:"2.0",popupOptions:{width:559,height:519}},bitbucket:{name:"bitbucket",url:"/auth/bitbucket",authorizationEndpoint:"https://bitbucket.org/site/oauth2/authorize",redirectUri:e.location.origin+"/",requiredUrlParams:["scope"],scope:["email"],scopeDelimiter:" ",oauthType:"2.0",popupOptions:{width:1028,height:529}}}}).provider("$auth",["SatellizerConfig",function(e){Object.defineProperties(this,{httpInterceptor:{get:function(){return e.httpInterceptor},set:function(t){"function"==typeof t?e.httpInterceptor=t:e.httpInterceptor=function(){return t}}},baseUrl:{get:function(){return e.baseUrl},set:function(t){e.baseUrl=t}},loginUrl:{get:function(){return e.loginUrl},set:function(t){e.loginUrl=t}},signupUrl:{get:function(){return e.signupUrl},set:function(t){e.signupUrl=t}},tokenRoot:{get:function(){return e.tokenRoot},set:function(t){e.tokenRoot=t}},tokenName:{get:function(){return e.tokenName},set:function(t){e.tokenName=t}},tokenPrefix:{get:function(){return e.tokenPrefix},set:function(t){e.tokenPrefix=t}},unlinkUrl:{get:function(){return e.unlinkUrl},set:function(t){e.unlinkUrl=t}},authHeader:{get:function(){return e.authHeader},set:function(t){e.authHeader=t}},authToken:{get:function(){return e.authToken},set:function(t){e.authToken=t}},withCredentials:{get:function(){return e.withCredentials},set:function(t){e.withCredentials=t}},cordova:{get:function(){return e.cordova},set:function(t){e.cordova=t}},storageType:{get:function(){return e.storageType},set:function(t){e.storageType=t}}}),t.forEach(Object.keys(e.providers),function(r){this[r]=function(n){return t.extend(e.providers[r],n)}},this);var r=function(r){e.providers[r.name]=e.providers[r.name]||{},t.extend(e.providers[r.name],r)};this.oauth1=function(t){r(t),e.providers[t.name].oauthType="1.0"},this.oauth2=function(t){r(t),e.providers[t.name].oauthType="2.0"},this.$get=["$q","SatellizerShared","SatellizerLocal","SatellizerOauth",function(e,t,r,n){var o={};return o.login=function(e,t){return r.login(e,t)},o.signup=function(e,t){return r.signup(e,t)},o.logout=function(){return t.logout()},o.authenticate=function(e,t){return n.authenticate(e,t)},o.link=function(e,t){return n.authenticate(e,t)},o.unlink=function(e,t){return n.unlink(e,t)},o.isAuthenticated=function(){return t.isAuthenticated()},o.getToken=function(){return t.getToken()},o.setToken=function(e){t.setToken({access_token:e})},o.removeToken=function(){return t.removeToken()},o.getPayload=function(){return t.getPayload()},o.setStorageType=function(e){return t.setStorageType(e)},o}]}]).factory("SatellizerShared",["$q","$window","$log","SatellizerConfig","SatellizerStorage",function(n,o,i,a,u){var p={},l=a.tokenPrefix?[a.tokenPrefix,a.tokenName].join("_"):a.tokenName;return p.getToken=function(){return u.get(l)},p.getPayload=function(){var t=u.get(l);if(t&&3===t.split(".").length)try{var n=t.split(".")[1],o=n.replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(decodeURIComponent(escape(e.atob(o))))}catch(i){return r}},p.setToken=function(e){if(!e)return i.warn("Can't set token without passing a value");var r,n=e&&e.access_token;if(n&&(t.isObject(n)&&t.isObject(n.data)?e=n:t.isString(n)&&(r=n)),!r&&e){var o=a.tokenRoot&&a.tokenRoot.split(".").reduce(function(e,t){return e[t]},e.data);r=o?o[a.tokenName]:e.data&&e.data[a.tokenName]}if(!r){var p=a.tokenRoot?a.tokenRoot+"."+a.tokenName:a.tokenName;return i.warn('Expecting a token named "'+p)}u.set(l,r)},p.removeToken=function(){u.remove(l)},p.isAuthenticated=function(){var e=u.get(l);if(e){if(3===e.split(".").length)try{var t=e.split(".")[1],r=t.replace(/-/g,"+").replace(/_/g,"/"),n=JSON.parse(o.atob(r)).exp;if(n){var i=Math.round((new Date).getTime()/1e3)>=n;return i?(u.remove(l),!1):!0}}catch(a){return!0}return!0}return!1},p.logout=function(){return u.remove(l),n.when()},p.setStorageType=function(e){a.storageType=e},p}]).factory("SatellizerOauth",["$q","$http","SatellizerConfig","SatellizerUtils","SatellizerShared","SatellizerOauth1","SatellizerOauth2",function(e,t,r,n,o,i,a){var u={};return u.authenticate=function(t,n){var u="1.0"===r.providers[t].oauthType?new i:new a,p=e.defer();return u.open(r.providers[t],n||{}).then(function(e){r.providers[t].url&&o.setToken(e,!1),p.resolve(e)})["catch"](function(e){p.reject(e)}),p.promise},u.unlink=function(e,o){return o=o||{},o.url=o.url?o.url:n.joinUrl(r.baseUrl,r.unlinkUrl),o.data={provider:e}||o.data,o.method=o.method||"POST",o.withCredentials=o.withCredentials||r.withCredentials,t(o)},u}]).factory("SatellizerLocal",["$http","SatellizerUtils","SatellizerShared","SatellizerConfig",function(e,t,r,n){var o={};return o.login=function(o,i){return i=i||{},i.url=i.url?i.url:t.joinUrl(n.baseUrl,n.loginUrl),i.data=o||i.data,i.method=i.method||"POST",i.withCredentials=i.withCredentials||n.withCredentials,e(i).then(function(e){return r.setToken(e),e})},o.signup=function(r,o){return o=o||{},o.url=o.url?o.url:t.joinUrl(n.baseUrl,n.signupUrl),o.data=r||o.data,o.method=o.method||"POST",o.withCredentials=o.withCredentials||n.withCredentials,e(o)},o}]).factory("SatellizerOauth2",["$q","$http","$window","SatellizerPopup","SatellizerUtils","SatellizerConfig","SatellizerStorage",function(e,r,n,o,i,a,u){return function(){var n={},p={defaultUrlParams:["response_type","client_id","redirect_uri"],responseType:"code",responseParams:{code:"code",clientId:"clientId",redirectUri:"redirectUri"}};return n.open=function(r,l){p=i.merge(r,p);var c,s,h=p.name+"_state";return t.isFunction(p.state)?u.set(h,p.state()):t.isString(p.state)&&u.set(h,p.state),c=[p.authorizationEndpoint,n.buildQueryString()].join("?"),s=a.cordova?o.open(c,p.name,p.popupOptions,p.redirectUri).eventListener(p.redirectUri):o.open(c,p.name,p.popupOptions,p.redirectUri).pollPopup(),s.then(function(t){return"token"!==p.responseType&&p.url?t.state&&t.state!==u.get(h)?e.reject('OAuth "state" mismatch'):n.exchangeForToken(t,l):t})},n.exchangeForToken=function(e,n){var o=t.extend({},n);t.forEach(p.responseParams,function(t,r){switch(r){case"code":o[t]=e.code;break;case"clientId":o[t]=p.clientId;break;case"redirectUri":o[t]=p.redirectUri;break;default:o[t]=e[r]}}),e.state&&(o.state=e.state);var u=a.baseUrl?i.joinUrl(a.baseUrl,p.url):p.url;return r.post(u,o,{withCredentials:a.withCredentials})},n.buildQueryString=function(){var e=[],r=["defaultUrlParams","requiredUrlParams","optionalUrlParams"];return t.forEach(r,function(r){t.forEach(p[r],function(r){var n=i.camelCase(r),o=t.isFunction(p[r])?p[r]():p[n];if("redirect_uri"!==r||o){if("state"===r){var a=p.name+"_state";o=encodeURIComponent(u.get(a))}"scope"===r&&Array.isArray(o)&&(o=o.join(p.scopeDelimiter),p.scopePrefix&&(o=[p.scopePrefix,o].join(p.scopeDelimiter))),e.push([r,o])}})}),e.map(function(e){return e.join("=")}).join("&")},n}}]).factory("SatellizerOauth1",["$q","$http","SatellizerPopup","SatellizerConfig","SatellizerUtils",function(e,r,n,o,i){return function(){var e={},a={url:null,name:null,popupOptions:null,redirectUri:null,authorizationEndpoint:null};return e.open=function(u,p){t.extend(a,u);var l,c=o.baseUrl?i.joinUrl(o.baseUrl,a.url):a.url;return o.cordova||(l=n.open("",a.name,a.popupOptions,a.redirectUri)),r.post(c,a).then(function(t){var r=[a.authorizationEndpoint,e.buildQueryString(t.data)].join("?");o.cordova?l=n.open(r,a.name,a.popupOptions,a.redirectUri):l.popupWindow.location=r;var i;return i=o.cordova?l.eventListener(a.redirectUri):l.pollPopup(),i.then(function(t){return e.exchangeForToken(t,p)})})},e.exchangeForToken=function(e,n){var u=t.extend({},n,e),p=o.baseUrl?i.joinUrl(o.baseUrl,a.url):a.url;return r.post(p,u,{withCredentials:o.withCredentials})},e.buildQueryString=function(e){var r=[];return t.forEach(e,function(e,t){r.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}),r.join("&")},e}}]).factory("SatellizerPopup",["$q","$interval","$window","SatellizerConfig","SatellizerUtils",function(e,n,o,i,a){var u={};return u.url="",u.popupWindow=null,u.open=function(e,t,r){u.url=e;var n=u.stringifyOptions(u.prepareOptions(r)),a=o.navigator.userAgent,p=i.cordova||a.indexOf("CriOS")>-1?"_blank":t;return u.popupWindow=o.open(e,p,n),o.popup=u.popupWindow,u.popupWindow&&u.popupWindow.focus&&u.popupWindow.focus(),u},u.eventListener=function(r){var n=e.defer();return u.popupWindow.addEventListener("loadstart",function(e){if(0===e.url.indexOf(r)){var o=document.createElement("a");if(o.href=e.url,o.search||o.hash){var i=o.search.substring(1).replace(/\/$/,""),p=o.hash.substring(1).replace(/\/$/,""),l=a.parseQueryString(p),c=a.parseQueryString(i);t.extend(c,l),c.error||n.resolve(c),u.popupWindow.close()}}}),u.popupWindow.addEventListener("loaderror",function(){n.reject("Authorization Failed")}),n.promise},u.pollPopup=function(){var o=e.defer(),i=n(function(){try{var e=document.location.host,p=u.popupWindow.location.host;if(p===e&&(u.popupWindow.location.search||u.popupWindow.location.hash)){var l=u.popupWindow.location.search.substring(1).replace(/\/$/,""),c=u.popupWindow.location.hash.substring(1).replace(/[\/$]/,""),s=a.parseQueryString(c),h=a.parseQueryString(l);t.extend(h,s),h.error?o.reject(h):o.resolve(h),n.cancel(i),u.popupWindow.close()}}catch(d){}(!u.popupWindow||u.popupWindow.closed||u.popupWindow.closed===r)&&n.cancel(i)},20);return o.promise},u.prepareOptions=function(e){e=e||{};var r=e.width||500,n=e.height||500;return t.extend({width:r,height:n,left:o.screenX+(o.outerWidth-r)/2,top:o.screenY+(o.outerHeight-n)/2.5},e)},u.stringifyOptions=function(e){var r=[];return t.forEach(e,function(e,t){r.push(t+"="+e)}),r.join(",")},u}]).service("SatellizerUtils",function(){this.camelCase=function(e){return e.replace(/([\:\-\_]+(.))/g,function(e,t,r,n){return n?r.toUpperCase():r})},this.parseQueryString=function(e){var r,n,o={};return t.forEach((e||"").split("&"),function(e){e&&(n=e.split("="),r=decodeURIComponent(n[0]),o[r]=t.isDefined(n[1])?decodeURIComponent(n[1]):!0)}),o},this.joinUrl=function(e,t){if(/^(?:[a-z]+:)?\/\//i.test(t))return t;var r=[e,t].join("/"),n=function(e){return e.replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")};return n(r)},this.merge=function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(n in t&&"object"==typeof e[n]&&null!==n?r[n]=this.merge(e[n],t[n]):r[n]=e[n]);for(n in t)if(t.hasOwnProperty(n)){if(n in r)continue;r[n]=t[n]}return r}}).factory("SatellizerStorage",["$window","$log","SatellizerConfig",function(e,t,r){var n={},o=function(){try{var t=r.storageType in e&&null!==e[r.storageType];if(t){var n=Math.random().toString(36).substring(7);e[r.storageType].setItem(n,""),e[r.storageType].removeItem(n)}return t}catch(o){return!1}}();return o||t.warn(r.storageType+" is not available."),{get:function(t){return o?e[r.storageType].getItem(t):n[t]},set:function(t,i){return o?e[r.storageType].setItem(t,i):n[t]=i},remove:function(t){return o?e[r.storageType].removeItem(t):delete n[t]}}}]).factory("SatellizerInterceptor",["$q","SatellizerConfig","SatellizerStorage","SatellizerShared",function(e,t,r,n){return{request:function(e){if(e.skipAuthorization)return e;if(n.isAuthenticated()&&t.httpInterceptor(e)){var o=t.tokenPrefix?t.tokenPrefix+"_"+t.tokenName:t.tokenName,i=r.get(o);t.authHeader&&t.authToken&&(i=t.authToken+" "+i),e.headers[t.authHeader]=i}return e},responseError:function(t){return e.reject(t)}}}]).config(["$httpProvider",function(e){e.interceptors.push("SatellizerInterceptor")}])}(window,window.angular);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJzYXRlbGxpemVyLm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNhdGVsbGl6ZXIgMC4xMy40XG4gKiAoYykgMjAxNiBTYWhhdCBZYWxrYWJvdlxuICogTGljZW5zZTogTUlUXG4gKi9cblwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzJiZtb2R1bGUuZXhwb3J0cz09PWV4cG9ydHMmJihtb2R1bGUuZXhwb3J0cz1cInNhdGVsbGl6ZXJcIiksZnVuY3Rpb24oZSx0LHIpe1widXNlIHN0cmljdFwiO2UubG9jYXRpb24ub3JpZ2lufHwoZS5sb2NhdGlvbi5vcmlnaW49ZS5sb2NhdGlvbi5wcm90b2NvbCtcIi8vXCIrZS5sb2NhdGlvbi5ob3N0KSx0Lm1vZHVsZShcInNhdGVsbGl6ZXJcIixbXSkuY29uc3RhbnQoXCJTYXRlbGxpemVyQ29uZmlnXCIse2h0dHBJbnRlcmNlcHRvcjpmdW5jdGlvbigpe3JldHVybiEwfSx3aXRoQ3JlZGVudGlhbHM6ITEsdG9rZW5Sb290Om51bGwsY29yZG92YTohMSxiYXNlVXJsOlwiL1wiLGxvZ2luVXJsOlwiL2F1dGgvbG9naW5cIixzaWdudXBVcmw6XCIvYXV0aC9zaWdudXBcIix1bmxpbmtVcmw6XCIvYXV0aC91bmxpbmsvXCIsdG9rZW5OYW1lOlwidG9rZW5cIix0b2tlblByZWZpeDpcInNhdGVsbGl6ZXJcIixhdXRoSGVhZGVyOlwiQXV0aG9yaXphdGlvblwiLGF1dGhUb2tlbjpcIkJlYXJlclwiLHN0b3JhZ2VUeXBlOlwibG9jYWxTdG9yYWdlXCIscHJvdmlkZXJzOntmYWNlYm9vazp7bmFtZTpcImZhY2Vib29rXCIsdXJsOlwiL2F1dGgvZmFjZWJvb2tcIixhdXRob3JpemF0aW9uRW5kcG9pbnQ6XCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vdjIuNS9kaWFsb2cvb2F1dGhcIixyZWRpcmVjdFVyaTplLmxvY2F0aW9uLm9yaWdpbitcIi9cIixyZXF1aXJlZFVybFBhcmFtczpbXCJkaXNwbGF5XCIsXCJzY29wZVwiXSxzY29wZTpbXCJlbWFpbFwiXSxzY29wZURlbGltaXRlcjpcIixcIixkaXNwbGF5OlwicG9wdXBcIixvYXV0aFR5cGU6XCIyLjBcIixwb3B1cE9wdGlvbnM6e3dpZHRoOjU4MCxoZWlnaHQ6NDAwfX0sZ29vZ2xlOntuYW1lOlwiZ29vZ2xlXCIsdXJsOlwiL2F1dGgvZ29vZ2xlXCIsYXV0aG9yaXphdGlvbkVuZHBvaW50OlwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGhcIixyZWRpcmVjdFVyaTplLmxvY2F0aW9uLm9yaWdpbixyZXF1aXJlZFVybFBhcmFtczpbXCJzY29wZVwiXSxvcHRpb25hbFVybFBhcmFtczpbXCJkaXNwbGF5XCJdLHNjb3BlOltcInByb2ZpbGVcIixcImVtYWlsXCJdLHNjb3BlUHJlZml4Olwib3BlbmlkXCIsc2NvcGVEZWxpbWl0ZXI6XCIgXCIsZGlzcGxheTpcInBvcHVwXCIsb2F1dGhUeXBlOlwiMi4wXCIscG9wdXBPcHRpb25zOnt3aWR0aDo0NTIsaGVpZ2h0OjYzM319LGdpdGh1Yjp7bmFtZTpcImdpdGh1YlwiLHVybDpcIi9hdXRoL2dpdGh1YlwiLGF1dGhvcml6YXRpb25FbmRwb2ludDpcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hdXRob3JpemVcIixyZWRpcmVjdFVyaTplLmxvY2F0aW9uLm9yaWdpbixvcHRpb25hbFVybFBhcmFtczpbXCJzY29wZVwiXSxzY29wZTpbXCJ1c2VyOmVtYWlsXCJdLHNjb3BlRGVsaW1pdGVyOlwiIFwiLG9hdXRoVHlwZTpcIjIuMFwiLHBvcHVwT3B0aW9uczp7d2lkdGg6MTAyMCxoZWlnaHQ6NjE4fX0saW5zdGFncmFtOntuYW1lOlwiaW5zdGFncmFtXCIsdXJsOlwiL2F1dGgvaW5zdGFncmFtXCIsYXV0aG9yaXphdGlvbkVuZHBvaW50OlwiaHR0cHM6Ly9hcGkuaW5zdGFncmFtLmNvbS9vYXV0aC9hdXRob3JpemVcIixyZWRpcmVjdFVyaTplLmxvY2F0aW9uLm9yaWdpbixyZXF1aXJlZFVybFBhcmFtczpbXCJzY29wZVwiXSxzY29wZTpbXCJiYXNpY1wiXSxzY29wZURlbGltaXRlcjpcIitcIixvYXV0aFR5cGU6XCIyLjBcIn0sbGlua2VkaW46e25hbWU6XCJsaW5rZWRpblwiLHVybDpcIi9hdXRoL2xpbmtlZGluXCIsYXV0aG9yaXphdGlvbkVuZHBvaW50OlwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL3Vhcy9vYXV0aDIvYXV0aG9yaXphdGlvblwiLHJlZGlyZWN0VXJpOmUubG9jYXRpb24ub3JpZ2luLHJlcXVpcmVkVXJsUGFyYW1zOltcInN0YXRlXCJdLHNjb3BlOltcInJfZW1haWxhZGRyZXNzXCJdLHNjb3BlRGVsaW1pdGVyOlwiIFwiLHN0YXRlOlwiU1RBVEVcIixvYXV0aFR5cGU6XCIyLjBcIixwb3B1cE9wdGlvbnM6e3dpZHRoOjUyNyxoZWlnaHQ6NTgyfX0sdHdpdHRlcjp7bmFtZTpcInR3aXR0ZXJcIix1cmw6XCIvYXV0aC90d2l0dGVyXCIsYXV0aG9yaXphdGlvbkVuZHBvaW50OlwiaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYXV0aGVudGljYXRlXCIscmVkaXJlY3RVcmk6ZS5sb2NhdGlvbi5vcmlnaW4sb2F1dGhUeXBlOlwiMS4wXCIscG9wdXBPcHRpb25zOnt3aWR0aDo0OTUsaGVpZ2h0OjY0NX19LHR3aXRjaDp7bmFtZTpcInR3aXRjaFwiLHVybDpcIi9hdXRoL3R3aXRjaFwiLGF1dGhvcml6YXRpb25FbmRwb2ludDpcImh0dHBzOi8vYXBpLnR3aXRjaC50di9rcmFrZW4vb2F1dGgyL2F1dGhvcml6ZVwiLHJlZGlyZWN0VXJpOmUubG9jYXRpb24ub3JpZ2luLHJlcXVpcmVkVXJsUGFyYW1zOltcInNjb3BlXCJdLHNjb3BlOltcInVzZXJfcmVhZFwiXSxzY29wZURlbGltaXRlcjpcIiBcIixkaXNwbGF5OlwicG9wdXBcIixvYXV0aFR5cGU6XCIyLjBcIixwb3B1cE9wdGlvbnM6e3dpZHRoOjUwMCxoZWlnaHQ6NTYwfX0sbGl2ZTp7bmFtZTpcImxpdmVcIix1cmw6XCIvYXV0aC9saXZlXCIsYXV0aG9yaXphdGlvbkVuZHBvaW50OlwiaHR0cHM6Ly9sb2dpbi5saXZlLmNvbS9vYXV0aDIwX2F1dGhvcml6ZS5zcmZcIixyZWRpcmVjdFVyaTplLmxvY2F0aW9uLm9yaWdpbixyZXF1aXJlZFVybFBhcmFtczpbXCJkaXNwbGF5XCIsXCJzY29wZVwiXSxzY29wZTpbXCJ3bC5lbWFpbHNcIl0sc2NvcGVEZWxpbWl0ZXI6XCIgXCIsZGlzcGxheTpcInBvcHVwXCIsb2F1dGhUeXBlOlwiMi4wXCIscG9wdXBPcHRpb25zOnt3aWR0aDo1MDAsaGVpZ2h0OjU2MH19LHlhaG9vOntuYW1lOlwieWFob29cIix1cmw6XCIvYXV0aC95YWhvb1wiLGF1dGhvcml6YXRpb25FbmRwb2ludDpcImh0dHBzOi8vYXBpLmxvZ2luLnlhaG9vLmNvbS9vYXV0aDIvcmVxdWVzdF9hdXRoXCIscmVkaXJlY3RVcmk6ZS5sb2NhdGlvbi5vcmlnaW4sc2NvcGU6W10sc2NvcGVEZWxpbWl0ZXI6XCIsXCIsb2F1dGhUeXBlOlwiMi4wXCIscG9wdXBPcHRpb25zOnt3aWR0aDo1NTksaGVpZ2h0OjUxOX19LGJpdGJ1Y2tldDp7bmFtZTpcImJpdGJ1Y2tldFwiLHVybDpcIi9hdXRoL2JpdGJ1Y2tldFwiLGF1dGhvcml6YXRpb25FbmRwb2ludDpcImh0dHBzOi8vYml0YnVja2V0Lm9yZy9zaXRlL29hdXRoMi9hdXRob3JpemVcIixyZWRpcmVjdFVyaTplLmxvY2F0aW9uLm9yaWdpbitcIi9cIixyZXF1aXJlZFVybFBhcmFtczpbXCJzY29wZVwiXSxzY29wZTpbXCJlbWFpbFwiXSxzY29wZURlbGltaXRlcjpcIiBcIixvYXV0aFR5cGU6XCIyLjBcIixwb3B1cE9wdGlvbnM6e3dpZHRoOjEwMjgsaGVpZ2h0OjUyOX19fX0pLnByb3ZpZGVyKFwiJGF1dGhcIixbXCJTYXRlbGxpemVyQ29uZmlnXCIsZnVuY3Rpb24oZSl7T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcyx7aHR0cEludGVyY2VwdG9yOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5odHRwSW50ZXJjZXB0b3J9LHNldDpmdW5jdGlvbih0KXtcImZ1bmN0aW9uXCI9PXR5cGVvZiB0P2UuaHR0cEludGVyY2VwdG9yPXQ6ZS5odHRwSW50ZXJjZXB0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdH19fSxiYXNlVXJsOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5iYXNlVXJsfSxzZXQ6ZnVuY3Rpb24odCl7ZS5iYXNlVXJsPXR9fSxsb2dpblVybDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUubG9naW5Vcmx9LHNldDpmdW5jdGlvbih0KXtlLmxvZ2luVXJsPXR9fSxzaWdudXBVcmw6e2dldDpmdW5jdGlvbigpe3JldHVybiBlLnNpZ251cFVybH0sc2V0OmZ1bmN0aW9uKHQpe2Uuc2lnbnVwVXJsPXR9fSx0b2tlblJvb3Q6e2dldDpmdW5jdGlvbigpe3JldHVybiBlLnRva2VuUm9vdH0sc2V0OmZ1bmN0aW9uKHQpe2UudG9rZW5Sb290PXR9fSx0b2tlbk5hbWU6e2dldDpmdW5jdGlvbigpe3JldHVybiBlLnRva2VuTmFtZX0sc2V0OmZ1bmN0aW9uKHQpe2UudG9rZW5OYW1lPXR9fSx0b2tlblByZWZpeDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUudG9rZW5QcmVmaXh9LHNldDpmdW5jdGlvbih0KXtlLnRva2VuUHJlZml4PXR9fSx1bmxpbmtVcmw6e2dldDpmdW5jdGlvbigpe3JldHVybiBlLnVubGlua1VybH0sc2V0OmZ1bmN0aW9uKHQpe2UudW5saW5rVXJsPXR9fSxhdXRoSGVhZGVyOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5hdXRoSGVhZGVyfSxzZXQ6ZnVuY3Rpb24odCl7ZS5hdXRoSGVhZGVyPXR9fSxhdXRoVG9rZW46e2dldDpmdW5jdGlvbigpe3JldHVybiBlLmF1dGhUb2tlbn0sc2V0OmZ1bmN0aW9uKHQpe2UuYXV0aFRva2VuPXR9fSx3aXRoQ3JlZGVudGlhbHM6e2dldDpmdW5jdGlvbigpe3JldHVybiBlLndpdGhDcmVkZW50aWFsc30sc2V0OmZ1bmN0aW9uKHQpe2Uud2l0aENyZWRlbnRpYWxzPXR9fSxjb3Jkb3ZhOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5jb3Jkb3ZhfSxzZXQ6ZnVuY3Rpb24odCl7ZS5jb3Jkb3ZhPXR9fSxzdG9yYWdlVHlwZTp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuc3RvcmFnZVR5cGV9LHNldDpmdW5jdGlvbih0KXtlLnN0b3JhZ2VUeXBlPXR9fX0pLHQuZm9yRWFjaChPYmplY3Qua2V5cyhlLnByb3ZpZGVycyksZnVuY3Rpb24ocil7dGhpc1tyXT1mdW5jdGlvbihuKXtyZXR1cm4gdC5leHRlbmQoZS5wcm92aWRlcnNbcl0sbil9fSx0aGlzKTt2YXIgcj1mdW5jdGlvbihyKXtlLnByb3ZpZGVyc1tyLm5hbWVdPWUucHJvdmlkZXJzW3IubmFtZV18fHt9LHQuZXh0ZW5kKGUucHJvdmlkZXJzW3IubmFtZV0scil9O3RoaXMub2F1dGgxPWZ1bmN0aW9uKHQpe3IodCksZS5wcm92aWRlcnNbdC5uYW1lXS5vYXV0aFR5cGU9XCIxLjBcIn0sdGhpcy5vYXV0aDI9ZnVuY3Rpb24odCl7cih0KSxlLnByb3ZpZGVyc1t0Lm5hbWVdLm9hdXRoVHlwZT1cIjIuMFwifSx0aGlzLiRnZXQ9W1wiJHFcIixcIlNhdGVsbGl6ZXJTaGFyZWRcIixcIlNhdGVsbGl6ZXJMb2NhbFwiLFwiU2F0ZWxsaXplck9hdXRoXCIsZnVuY3Rpb24oZSx0LHIsbil7dmFyIG89e307cmV0dXJuIG8ubG9naW49ZnVuY3Rpb24oZSx0KXtyZXR1cm4gci5sb2dpbihlLHQpfSxvLnNpZ251cD1mdW5jdGlvbihlLHQpe3JldHVybiByLnNpZ251cChlLHQpfSxvLmxvZ291dD1mdW5jdGlvbigpe3JldHVybiB0LmxvZ291dCgpfSxvLmF1dGhlbnRpY2F0ZT1mdW5jdGlvbihlLHQpe3JldHVybiBuLmF1dGhlbnRpY2F0ZShlLHQpfSxvLmxpbms9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5hdXRoZW50aWNhdGUoZSx0KX0sby51bmxpbms9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi51bmxpbmsoZSx0KX0sby5pc0F1dGhlbnRpY2F0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdC5pc0F1dGhlbnRpY2F0ZWQoKX0sby5nZXRUb2tlbj1mdW5jdGlvbigpe3JldHVybiB0LmdldFRva2VuKCl9LG8uc2V0VG9rZW49ZnVuY3Rpb24oZSl7dC5zZXRUb2tlbih7YWNjZXNzX3Rva2VuOmV9KX0sby5yZW1vdmVUb2tlbj1mdW5jdGlvbigpe3JldHVybiB0LnJlbW92ZVRva2VuKCl9LG8uZ2V0UGF5bG9hZD1mdW5jdGlvbigpe3JldHVybiB0LmdldFBheWxvYWQoKX0sby5zZXRTdG9yYWdlVHlwZT1mdW5jdGlvbihlKXtyZXR1cm4gdC5zZXRTdG9yYWdlVHlwZShlKX0sb31dfV0pLmZhY3RvcnkoXCJTYXRlbGxpemVyU2hhcmVkXCIsW1wiJHFcIixcIiR3aW5kb3dcIixcIiRsb2dcIixcIlNhdGVsbGl6ZXJDb25maWdcIixcIlNhdGVsbGl6ZXJTdG9yYWdlXCIsZnVuY3Rpb24obixvLGksYSx1KXt2YXIgcD17fSxsPWEudG9rZW5QcmVmaXg/W2EudG9rZW5QcmVmaXgsYS50b2tlbk5hbWVdLmpvaW4oXCJfXCIpOmEudG9rZW5OYW1lO3JldHVybiBwLmdldFRva2VuPWZ1bmN0aW9uKCl7cmV0dXJuIHUuZ2V0KGwpfSxwLmdldFBheWxvYWQ9ZnVuY3Rpb24oKXt2YXIgdD11LmdldChsKTtpZih0JiYzPT09dC5zcGxpdChcIi5cIikubGVuZ3RoKXRyeXt2YXIgbj10LnNwbGl0KFwiLlwiKVsxXSxvPW4ucmVwbGFjZSgvLS9nLFwiK1wiKS5yZXBsYWNlKC9fL2csXCIvXCIpO3JldHVybiBKU09OLnBhcnNlKGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUoZS5hdG9iKG8pKSkpfWNhdGNoKGkpe3JldHVybiByfX0scC5zZXRUb2tlbj1mdW5jdGlvbihlKXtpZighZSlyZXR1cm4gaS53YXJuKFwiQ2FuJ3Qgc2V0IHRva2VuIHdpdGhvdXQgcGFzc2luZyBhIHZhbHVlXCIpO3ZhciByLG49ZSYmZS5hY2Nlc3NfdG9rZW47aWYobiYmKHQuaXNPYmplY3QobikmJnQuaXNPYmplY3Qobi5kYXRhKT9lPW46dC5pc1N0cmluZyhuKSYmKHI9bikpLCFyJiZlKXt2YXIgbz1hLnRva2VuUm9vdCYmYS50b2tlblJvb3Quc3BsaXQoXCIuXCIpLnJlZHVjZShmdW5jdGlvbihlLHQpe3JldHVybiBlW3RdfSxlLmRhdGEpO3I9bz9vW2EudG9rZW5OYW1lXTplLmRhdGEmJmUuZGF0YVthLnRva2VuTmFtZV19aWYoIXIpe3ZhciBwPWEudG9rZW5Sb290P2EudG9rZW5Sb290K1wiLlwiK2EudG9rZW5OYW1lOmEudG9rZW5OYW1lO3JldHVybiBpLndhcm4oJ0V4cGVjdGluZyBhIHRva2VuIG5hbWVkIFwiJytwKX11LnNldChsLHIpfSxwLnJlbW92ZVRva2VuPWZ1bmN0aW9uKCl7dS5yZW1vdmUobCl9LHAuaXNBdXRoZW50aWNhdGVkPWZ1bmN0aW9uKCl7dmFyIGU9dS5nZXQobCk7aWYoZSl7aWYoMz09PWUuc3BsaXQoXCIuXCIpLmxlbmd0aCl0cnl7dmFyIHQ9ZS5zcGxpdChcIi5cIilbMV0scj10LnJlcGxhY2UoLy0vZyxcIitcIikucmVwbGFjZSgvXy9nLFwiL1wiKSxuPUpTT04ucGFyc2Uoby5hdG9iKHIpKS5leHA7aWYobil7dmFyIGk9TWF0aC5yb3VuZCgobmV3IERhdGUpLmdldFRpbWUoKS8xZTMpPj1uO3JldHVybiBpPyh1LnJlbW92ZShsKSwhMSk6ITB9fWNhdGNoKGEpe3JldHVybiEwfXJldHVybiEwfXJldHVybiExfSxwLmxvZ291dD1mdW5jdGlvbigpe3JldHVybiB1LnJlbW92ZShsKSxuLndoZW4oKX0scC5zZXRTdG9yYWdlVHlwZT1mdW5jdGlvbihlKXthLnN0b3JhZ2VUeXBlPWV9LHB9XSkuZmFjdG9yeShcIlNhdGVsbGl6ZXJPYXV0aFwiLFtcIiRxXCIsXCIkaHR0cFwiLFwiU2F0ZWxsaXplckNvbmZpZ1wiLFwiU2F0ZWxsaXplclV0aWxzXCIsXCJTYXRlbGxpemVyU2hhcmVkXCIsXCJTYXRlbGxpemVyT2F1dGgxXCIsXCJTYXRlbGxpemVyT2F1dGgyXCIsZnVuY3Rpb24oZSx0LHIsbixvLGksYSl7dmFyIHU9e307cmV0dXJuIHUuYXV0aGVudGljYXRlPWZ1bmN0aW9uKHQsbil7dmFyIHU9XCIxLjBcIj09PXIucHJvdmlkZXJzW3RdLm9hdXRoVHlwZT9uZXcgaTpuZXcgYSxwPWUuZGVmZXIoKTtyZXR1cm4gdS5vcGVuKHIucHJvdmlkZXJzW3RdLG58fHt9KS50aGVuKGZ1bmN0aW9uKGUpe3IucHJvdmlkZXJzW3RdLnVybCYmby5zZXRUb2tlbihlLCExKSxwLnJlc29sdmUoZSl9KVtcImNhdGNoXCJdKGZ1bmN0aW9uKGUpe3AucmVqZWN0KGUpfSkscC5wcm9taXNlfSx1LnVubGluaz1mdW5jdGlvbihlLG8pe3JldHVybiBvPW98fHt9LG8udXJsPW8udXJsP28udXJsOm4uam9pblVybChyLmJhc2VVcmwsci51bmxpbmtVcmwpLG8uZGF0YT17cHJvdmlkZXI6ZX18fG8uZGF0YSxvLm1ldGhvZD1vLm1ldGhvZHx8XCJQT1NUXCIsby53aXRoQ3JlZGVudGlhbHM9by53aXRoQ3JlZGVudGlhbHN8fHIud2l0aENyZWRlbnRpYWxzLHQobyl9LHV9XSkuZmFjdG9yeShcIlNhdGVsbGl6ZXJMb2NhbFwiLFtcIiRodHRwXCIsXCJTYXRlbGxpemVyVXRpbHNcIixcIlNhdGVsbGl6ZXJTaGFyZWRcIixcIlNhdGVsbGl6ZXJDb25maWdcIixmdW5jdGlvbihlLHQscixuKXt2YXIgbz17fTtyZXR1cm4gby5sb2dpbj1mdW5jdGlvbihvLGkpe3JldHVybiBpPWl8fHt9LGkudXJsPWkudXJsP2kudXJsOnQuam9pblVybChuLmJhc2VVcmwsbi5sb2dpblVybCksaS5kYXRhPW98fGkuZGF0YSxpLm1ldGhvZD1pLm1ldGhvZHx8XCJQT1NUXCIsaS53aXRoQ3JlZGVudGlhbHM9aS53aXRoQ3JlZGVudGlhbHN8fG4ud2l0aENyZWRlbnRpYWxzLGUoaSkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gci5zZXRUb2tlbihlKSxlfSl9LG8uc2lnbnVwPWZ1bmN0aW9uKHIsbyl7cmV0dXJuIG89b3x8e30sby51cmw9by51cmw/by51cmw6dC5qb2luVXJsKG4uYmFzZVVybCxuLnNpZ251cFVybCksby5kYXRhPXJ8fG8uZGF0YSxvLm1ldGhvZD1vLm1ldGhvZHx8XCJQT1NUXCIsby53aXRoQ3JlZGVudGlhbHM9by53aXRoQ3JlZGVudGlhbHN8fG4ud2l0aENyZWRlbnRpYWxzLGUobyl9LG99XSkuZmFjdG9yeShcIlNhdGVsbGl6ZXJPYXV0aDJcIixbXCIkcVwiLFwiJGh0dHBcIixcIiR3aW5kb3dcIixcIlNhdGVsbGl6ZXJQb3B1cFwiLFwiU2F0ZWxsaXplclV0aWxzXCIsXCJTYXRlbGxpemVyQ29uZmlnXCIsXCJTYXRlbGxpemVyU3RvcmFnZVwiLGZ1bmN0aW9uKGUscixuLG8saSxhLHUpe3JldHVybiBmdW5jdGlvbigpe3ZhciBuPXt9LHA9e2RlZmF1bHRVcmxQYXJhbXM6W1wicmVzcG9uc2VfdHlwZVwiLFwiY2xpZW50X2lkXCIsXCJyZWRpcmVjdF91cmlcIl0scmVzcG9uc2VUeXBlOlwiY29kZVwiLHJlc3BvbnNlUGFyYW1zOntjb2RlOlwiY29kZVwiLGNsaWVudElkOlwiY2xpZW50SWRcIixyZWRpcmVjdFVyaTpcInJlZGlyZWN0VXJpXCJ9fTtyZXR1cm4gbi5vcGVuPWZ1bmN0aW9uKHIsbCl7cD1pLm1lcmdlKHIscCk7dmFyIGMscyxoPXAubmFtZStcIl9zdGF0ZVwiO3JldHVybiB0LmlzRnVuY3Rpb24ocC5zdGF0ZSk/dS5zZXQoaCxwLnN0YXRlKCkpOnQuaXNTdHJpbmcocC5zdGF0ZSkmJnUuc2V0KGgscC5zdGF0ZSksYz1bcC5hdXRob3JpemF0aW9uRW5kcG9pbnQsbi5idWlsZFF1ZXJ5U3RyaW5nKCldLmpvaW4oXCI/XCIpLHM9YS5jb3Jkb3ZhP28ub3BlbihjLHAubmFtZSxwLnBvcHVwT3B0aW9ucyxwLnJlZGlyZWN0VXJpKS5ldmVudExpc3RlbmVyKHAucmVkaXJlY3RVcmkpOm8ub3BlbihjLHAubmFtZSxwLnBvcHVwT3B0aW9ucyxwLnJlZGlyZWN0VXJpKS5wb2xsUG9wdXAoKSxzLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuXCJ0b2tlblwiIT09cC5yZXNwb25zZVR5cGUmJnAudXJsP3Quc3RhdGUmJnQuc3RhdGUhPT11LmdldChoKT9lLnJlamVjdCgnT0F1dGggXCJzdGF0ZVwiIG1pc21hdGNoJyk6bi5leGNoYW5nZUZvclRva2VuKHQsbCk6dH0pfSxuLmV4Y2hhbmdlRm9yVG9rZW49ZnVuY3Rpb24oZSxuKXt2YXIgbz10LmV4dGVuZCh7fSxuKTt0LmZvckVhY2gocC5yZXNwb25zZVBhcmFtcyxmdW5jdGlvbih0LHIpe3N3aXRjaChyKXtjYXNlXCJjb2RlXCI6b1t0XT1lLmNvZGU7YnJlYWs7Y2FzZVwiY2xpZW50SWRcIjpvW3RdPXAuY2xpZW50SWQ7YnJlYWs7Y2FzZVwicmVkaXJlY3RVcmlcIjpvW3RdPXAucmVkaXJlY3RVcmk7YnJlYWs7ZGVmYXVsdDpvW3RdPWVbcl19fSksZS5zdGF0ZSYmKG8uc3RhdGU9ZS5zdGF0ZSk7dmFyIHU9YS5iYXNlVXJsP2kuam9pblVybChhLmJhc2VVcmwscC51cmwpOnAudXJsO3JldHVybiByLnBvc3QodSxvLHt3aXRoQ3JlZGVudGlhbHM6YS53aXRoQ3JlZGVudGlhbHN9KX0sbi5idWlsZFF1ZXJ5U3RyaW5nPWZ1bmN0aW9uKCl7dmFyIGU9W10scj1bXCJkZWZhdWx0VXJsUGFyYW1zXCIsXCJyZXF1aXJlZFVybFBhcmFtc1wiLFwib3B0aW9uYWxVcmxQYXJhbXNcIl07cmV0dXJuIHQuZm9yRWFjaChyLGZ1bmN0aW9uKHIpe3QuZm9yRWFjaChwW3JdLGZ1bmN0aW9uKHIpe3ZhciBuPWkuY2FtZWxDYXNlKHIpLG89dC5pc0Z1bmN0aW9uKHBbcl0pP3Bbcl0oKTpwW25dO2lmKFwicmVkaXJlY3RfdXJpXCIhPT1yfHxvKXtpZihcInN0YXRlXCI9PT1yKXt2YXIgYT1wLm5hbWUrXCJfc3RhdGVcIjtvPWVuY29kZVVSSUNvbXBvbmVudCh1LmdldChhKSl9XCJzY29wZVwiPT09ciYmQXJyYXkuaXNBcnJheShvKSYmKG89by5qb2luKHAuc2NvcGVEZWxpbWl0ZXIpLHAuc2NvcGVQcmVmaXgmJihvPVtwLnNjb3BlUHJlZml4LG9dLmpvaW4ocC5zY29wZURlbGltaXRlcikpKSxlLnB1c2goW3Isb10pfX0pfSksZS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIGUuam9pbihcIj1cIil9KS5qb2luKFwiJlwiKX0sbn19XSkuZmFjdG9yeShcIlNhdGVsbGl6ZXJPYXV0aDFcIixbXCIkcVwiLFwiJGh0dHBcIixcIlNhdGVsbGl6ZXJQb3B1cFwiLFwiU2F0ZWxsaXplckNvbmZpZ1wiLFwiU2F0ZWxsaXplclV0aWxzXCIsZnVuY3Rpb24oZSxyLG4sbyxpKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZT17fSxhPXt1cmw6bnVsbCxuYW1lOm51bGwscG9wdXBPcHRpb25zOm51bGwscmVkaXJlY3RVcmk6bnVsbCxhdXRob3JpemF0aW9uRW5kcG9pbnQ6bnVsbH07cmV0dXJuIGUub3Blbj1mdW5jdGlvbih1LHApe3QuZXh0ZW5kKGEsdSk7dmFyIGwsYz1vLmJhc2VVcmw/aS5qb2luVXJsKG8uYmFzZVVybCxhLnVybCk6YS51cmw7cmV0dXJuIG8uY29yZG92YXx8KGw9bi5vcGVuKFwiXCIsYS5uYW1lLGEucG9wdXBPcHRpb25zLGEucmVkaXJlY3RVcmkpKSxyLnBvc3QoYyxhKS50aGVuKGZ1bmN0aW9uKHQpe3ZhciByPVthLmF1dGhvcml6YXRpb25FbmRwb2ludCxlLmJ1aWxkUXVlcnlTdHJpbmcodC5kYXRhKV0uam9pbihcIj9cIik7by5jb3Jkb3ZhP2w9bi5vcGVuKHIsYS5uYW1lLGEucG9wdXBPcHRpb25zLGEucmVkaXJlY3RVcmkpOmwucG9wdXBXaW5kb3cubG9jYXRpb249cjt2YXIgaTtyZXR1cm4gaT1vLmNvcmRvdmE/bC5ldmVudExpc3RlbmVyKGEucmVkaXJlY3RVcmkpOmwucG9sbFBvcHVwKCksaS50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBlLmV4Y2hhbmdlRm9yVG9rZW4odCxwKX0pfSl9LGUuZXhjaGFuZ2VGb3JUb2tlbj1mdW5jdGlvbihlLG4pe3ZhciB1PXQuZXh0ZW5kKHt9LG4sZSkscD1vLmJhc2VVcmw/aS5qb2luVXJsKG8uYmFzZVVybCxhLnVybCk6YS51cmw7cmV0dXJuIHIucG9zdChwLHUse3dpdGhDcmVkZW50aWFsczpvLndpdGhDcmVkZW50aWFsc30pfSxlLmJ1aWxkUXVlcnlTdHJpbmc9ZnVuY3Rpb24oZSl7dmFyIHI9W107cmV0dXJuIHQuZm9yRWFjaChlLGZ1bmN0aW9uKGUsdCl7ci5wdXNoKGVuY29kZVVSSUNvbXBvbmVudCh0KStcIj1cIitlbmNvZGVVUklDb21wb25lbnQoZSkpfSksci5qb2luKFwiJlwiKX0sZX19XSkuZmFjdG9yeShcIlNhdGVsbGl6ZXJQb3B1cFwiLFtcIiRxXCIsXCIkaW50ZXJ2YWxcIixcIiR3aW5kb3dcIixcIlNhdGVsbGl6ZXJDb25maWdcIixcIlNhdGVsbGl6ZXJVdGlsc1wiLGZ1bmN0aW9uKGUsbixvLGksYSl7dmFyIHU9e307cmV0dXJuIHUudXJsPVwiXCIsdS5wb3B1cFdpbmRvdz1udWxsLHUub3Blbj1mdW5jdGlvbihlLHQscil7dS51cmw9ZTt2YXIgbj11LnN0cmluZ2lmeU9wdGlvbnModS5wcmVwYXJlT3B0aW9ucyhyKSksYT1vLm5hdmlnYXRvci51c2VyQWdlbnQscD1pLmNvcmRvdmF8fGEuaW5kZXhPZihcIkNyaU9TXCIpPi0xP1wiX2JsYW5rXCI6dDtyZXR1cm4gdS5wb3B1cFdpbmRvdz1vLm9wZW4oZSxwLG4pLG8ucG9wdXA9dS5wb3B1cFdpbmRvdyx1LnBvcHVwV2luZG93JiZ1LnBvcHVwV2luZG93LmZvY3VzJiZ1LnBvcHVwV2luZG93LmZvY3VzKCksdX0sdS5ldmVudExpc3RlbmVyPWZ1bmN0aW9uKHIpe3ZhciBuPWUuZGVmZXIoKTtyZXR1cm4gdS5wb3B1cFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZHN0YXJ0XCIsZnVuY3Rpb24oZSl7aWYoMD09PWUudXJsLmluZGV4T2Yocikpe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO2lmKG8uaHJlZj1lLnVybCxvLnNlYXJjaHx8by5oYXNoKXt2YXIgaT1vLnNlYXJjaC5zdWJzdHJpbmcoMSkucmVwbGFjZSgvXFwvJC8sXCJcIikscD1vLmhhc2guc3Vic3RyaW5nKDEpLnJlcGxhY2UoL1xcLyQvLFwiXCIpLGw9YS5wYXJzZVF1ZXJ5U3RyaW5nKHApLGM9YS5wYXJzZVF1ZXJ5U3RyaW5nKGkpO3QuZXh0ZW5kKGMsbCksYy5lcnJvcnx8bi5yZXNvbHZlKGMpLHUucG9wdXBXaW5kb3cuY2xvc2UoKX19fSksdS5wb3B1cFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZGVycm9yXCIsZnVuY3Rpb24oKXtuLnJlamVjdChcIkF1dGhvcml6YXRpb24gRmFpbGVkXCIpfSksbi5wcm9taXNlfSx1LnBvbGxQb3B1cD1mdW5jdGlvbigpe3ZhciBvPWUuZGVmZXIoKSxpPW4oZnVuY3Rpb24oKXt0cnl7dmFyIGU9ZG9jdW1lbnQubG9jYXRpb24uaG9zdCxwPXUucG9wdXBXaW5kb3cubG9jYXRpb24uaG9zdDtpZihwPT09ZSYmKHUucG9wdXBXaW5kb3cubG9jYXRpb24uc2VhcmNofHx1LnBvcHVwV2luZG93LmxvY2F0aW9uLmhhc2gpKXt2YXIgbD11LnBvcHVwV2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSkucmVwbGFjZSgvXFwvJC8sXCJcIiksYz11LnBvcHVwV2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLnJlcGxhY2UoL1tcXC8kXS8sXCJcIikscz1hLnBhcnNlUXVlcnlTdHJpbmcoYyksaD1hLnBhcnNlUXVlcnlTdHJpbmcobCk7dC5leHRlbmQoaCxzKSxoLmVycm9yP28ucmVqZWN0KGgpOm8ucmVzb2x2ZShoKSxuLmNhbmNlbChpKSx1LnBvcHVwV2luZG93LmNsb3NlKCl9fWNhdGNoKGQpe30oIXUucG9wdXBXaW5kb3d8fHUucG9wdXBXaW5kb3cuY2xvc2VkfHx1LnBvcHVwV2luZG93LmNsb3NlZD09PXIpJiZuLmNhbmNlbChpKX0sMjApO3JldHVybiBvLnByb21pc2V9LHUucHJlcGFyZU9wdGlvbnM9ZnVuY3Rpb24oZSl7ZT1lfHx7fTt2YXIgcj1lLndpZHRofHw1MDAsbj1lLmhlaWdodHx8NTAwO3JldHVybiB0LmV4dGVuZCh7d2lkdGg6cixoZWlnaHQ6bixsZWZ0Om8uc2NyZWVuWCsoby5vdXRlcldpZHRoLXIpLzIsdG9wOm8uc2NyZWVuWSsoby5vdXRlckhlaWdodC1uKS8yLjV9LGUpfSx1LnN0cmluZ2lmeU9wdGlvbnM9ZnVuY3Rpb24oZSl7dmFyIHI9W107cmV0dXJuIHQuZm9yRWFjaChlLGZ1bmN0aW9uKGUsdCl7ci5wdXNoKHQrXCI9XCIrZSl9KSxyLmpvaW4oXCIsXCIpfSx1fV0pLnNlcnZpY2UoXCJTYXRlbGxpemVyVXRpbHNcIixmdW5jdGlvbigpe3RoaXMuY2FtZWxDYXNlPWZ1bmN0aW9uKGUpe3JldHVybiBlLnJlcGxhY2UoLyhbXFw6XFwtXFxfXSsoLikpL2csZnVuY3Rpb24oZSx0LHIsbil7cmV0dXJuIG4/ci50b1VwcGVyQ2FzZSgpOnJ9KX0sdGhpcy5wYXJzZVF1ZXJ5U3RyaW5nPWZ1bmN0aW9uKGUpe3ZhciByLG4sbz17fTtyZXR1cm4gdC5mb3JFYWNoKChlfHxcIlwiKS5zcGxpdChcIiZcIiksZnVuY3Rpb24oZSl7ZSYmKG49ZS5zcGxpdChcIj1cIikscj1kZWNvZGVVUklDb21wb25lbnQoblswXSksb1tyXT10LmlzRGVmaW5lZChuWzFdKT9kZWNvZGVVUklDb21wb25lbnQoblsxXSk6ITApfSksb30sdGhpcy5qb2luVXJsPWZ1bmN0aW9uKGUsdCl7aWYoL14oPzpbYS16XSs6KT9cXC9cXC8vaS50ZXN0KHQpKXJldHVybiB0O3ZhciByPVtlLHRdLmpvaW4oXCIvXCIpLG49ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZSgvW1xcL10rL2csXCIvXCIpLnJlcGxhY2UoL1xcL1xcPy9nLFwiP1wiKS5yZXBsYWNlKC9cXC9cXCMvZyxcIiNcIikucmVwbGFjZSgvXFw6XFwvL2csXCI6Ly9cIil9O3JldHVybiBuKHIpfSx0aGlzLm1lcmdlPWZ1bmN0aW9uKGUsdCl7dmFyIHI9e307Zm9yKHZhciBuIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShuKSYmKG4gaW4gdCYmXCJvYmplY3RcIj09dHlwZW9mIGVbbl0mJm51bGwhPT1uP3Jbbl09dGhpcy5tZXJnZShlW25dLHRbbl0pOnJbbl09ZVtuXSk7Zm9yKG4gaW4gdClpZih0Lmhhc093blByb3BlcnR5KG4pKXtpZihuIGluIHIpY29udGludWU7cltuXT10W25dfXJldHVybiByfX0pLmZhY3RvcnkoXCJTYXRlbGxpemVyU3RvcmFnZVwiLFtcIiR3aW5kb3dcIixcIiRsb2dcIixcIlNhdGVsbGl6ZXJDb25maWdcIixmdW5jdGlvbihlLHQscil7dmFyIG49e30sbz1mdW5jdGlvbigpe3RyeXt2YXIgdD1yLnN0b3JhZ2VUeXBlIGluIGUmJm51bGwhPT1lW3Iuc3RvcmFnZVR5cGVdO2lmKHQpe3ZhciBuPU1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZyg3KTtlW3Iuc3RvcmFnZVR5cGVdLnNldEl0ZW0obixcIlwiKSxlW3Iuc3RvcmFnZVR5cGVdLnJlbW92ZUl0ZW0obil9cmV0dXJuIHR9Y2F0Y2gobyl7cmV0dXJuITF9fSgpO3JldHVybiBvfHx0Lndhcm4oci5zdG9yYWdlVHlwZStcIiBpcyBub3QgYXZhaWxhYmxlLlwiKSx7Z2V0OmZ1bmN0aW9uKHQpe3JldHVybiBvP2Vbci5zdG9yYWdlVHlwZV0uZ2V0SXRlbSh0KTpuW3RdfSxzZXQ6ZnVuY3Rpb24odCxpKXtyZXR1cm4gbz9lW3Iuc3RvcmFnZVR5cGVdLnNldEl0ZW0odCxpKTpuW3RdPWl9LHJlbW92ZTpmdW5jdGlvbih0KXtyZXR1cm4gbz9lW3Iuc3RvcmFnZVR5cGVdLnJlbW92ZUl0ZW0odCk6ZGVsZXRlIG5bdF19fX1dKS5mYWN0b3J5KFwiU2F0ZWxsaXplckludGVyY2VwdG9yXCIsW1wiJHFcIixcIlNhdGVsbGl6ZXJDb25maWdcIixcIlNhdGVsbGl6ZXJTdG9yYWdlXCIsXCJTYXRlbGxpemVyU2hhcmVkXCIsZnVuY3Rpb24oZSx0LHIsbil7cmV0dXJue3JlcXVlc3Q6ZnVuY3Rpb24oZSl7aWYoZS5za2lwQXV0aG9yaXphdGlvbilyZXR1cm4gZTtpZihuLmlzQXV0aGVudGljYXRlZCgpJiZ0Lmh0dHBJbnRlcmNlcHRvcihlKSl7dmFyIG89dC50b2tlblByZWZpeD90LnRva2VuUHJlZml4K1wiX1wiK3QudG9rZW5OYW1lOnQudG9rZW5OYW1lLGk9ci5nZXQobyk7dC5hdXRoSGVhZGVyJiZ0LmF1dGhUb2tlbiYmKGk9dC5hdXRoVG9rZW4rXCIgXCIraSksZS5oZWFkZXJzW3QuYXV0aEhlYWRlcl09aX1yZXR1cm4gZX0scmVzcG9uc2VFcnJvcjpmdW5jdGlvbih0KXtyZXR1cm4gZS5yZWplY3QodCl9fX1dKS5jb25maWcoW1wiJGh0dHBQcm92aWRlclwiLGZ1bmN0aW9uKGUpe2UuaW50ZXJjZXB0b3JzLnB1c2goXCJTYXRlbGxpemVySW50ZXJjZXB0b3JcIil9XSl9KHdpbmRvdyx3aW5kb3cuYW5ndWxhcik7Il0sImZpbGUiOiJzYXRlbGxpemVyLm1pbi5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
